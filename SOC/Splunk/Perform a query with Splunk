
-- Upload data into Splunk -- 

To operate effectively, it's essential that SIEM tools ingest and index data. SIEM tools collect and process data so that it becomes searchable events that can be queried, viewed, and analyzed.

So far, you've created a Splunk account and activated and accessed the Splunk Cloud free trial, but your Splunk Cloud instance does not contain any data. Next, you'll need to upload data into Splunk to start querying. Complete the following steps to upload data into Splunk:

1. If you haven't already, download the data file from Step 1:  tutorialdata.zip. Click the link then click the download icon. Do not uncompress the file.
2. Navigate to Splunk Home from your Splunk Cloud free trial instance. You might need to log in again using your credentials from Step 3.
3. On the Splunk bar, click Settings. Then click the Add Data icon.
4. Click Upload.
5. Click the Select File button.
6. Upload the tutorialdata.zip file, and click Open.
7. Click the Next button to continue to Input Settings.
8. By the Host section, select Segment in path and enter 1 as the segment number.
9. Click the Review button and review the details of the upload before you submit. The details should be as follows: 

	Input Type: Uploaded File
	File Name: tutorialdata.zip
	Source Type: Automatic
	Host: Source path segment number: 1 
	Index: Default

10.    Click Submit. Once Splunk has ingested the data, you will receive confirmation that the file was successfully uploaded.

Note: If you are experiencing issues uploading data into Splunk, refer to the Splunk Search Tutorial  guide for help.
 
https://docs.splunk.com/Documentation/SplunkCloud/9.0.2209/SearchTutorial/GetthetutorialdataintoSplunk


-- Perform a basic search --

Take a moment to examine the Splunk Cloud interface by locating the app panel, the Explore Splunk panel, and the Splunk bar.

Now that you've uploaded the data into Splunk, perform your first query to confirm that the data has been ingested, indexed, and is searchable. Follow these steps to perform a query:

1. Navigate to Splunk Home. (To return to Splunk Home, click the Splunk Cloud logo on the Splunk Cloud page.)
2. Click Search & Reporting. You may close any pop ups that appear.

3. In the search bar,  enter your search query:
   index=main
   This search term specifies the index. An index is a repository for data. Here, the index is a single dataset containing events from an index named main.

4. Select All Time from the time range dropdown to search for all the events across all time.
5. Click the search button. Note that the search button is represented by the magnifying glass icon. Your search should retrieve thousands of events.

Pro tip: It's a best practice to use short time ranges in your searches because a shorter time range returns results faster and uses fewer resources. Adjust the time using the time range dropdown or by using time modifiers in your search.

https://docs.splunk.com/Documentation/SCS/current/Search/Timemodifiers


-- Evaluate the fields --

When Splunk indexes data, it attaches fields to each event. These fields become part of the searchable index event data. This helps security analysts easily search for and find the specific data they need. 

For each event the fields are host, source, and sourcetype. Under SELECTED FIELDS, examine the same fields.

Examine the field values by clicking on the field under SELECTED FIELDS. You should observe the following:

· host: The host field specifies the name of the network host from which the event originated. In this search there are five hosts:

	mailsv - Buttercup Games' mail server. Examine events generated from this host.
	www1 - This is one of Buttercup Games' web applications.
	www2 - This is one of Buttercup Games' web applications.
	www3 - This is one of Buttercup Games' web applications.
	vendor_sales - Information about Buttercup Games' retail sales.

· source: The source field indicates the file name from which the event originates. 
· sourcetype: The sourcetype determines how data is formatted.


-- Narrow your search --

Because you've been tasked with exploring any failed SSH logins for the root account on the mail server, you'll need to narrow the search results for events from the mail server.

Under SELECTED FIELDS, click host and click mailsv.

Notice that a new term has been added to the search bar: index=main host=mailsv. The search results have narrowed to over 9000 events that are generated by the mail server.


-- Search for a failed login for root --

Now that you've narrowed your search results to events generated by the mail server, continue to narrow the search to locate any failed SSH logins for the root account. 

1. Clear the search bar.
2. Enter index=main host=mailsv fail* root into the search bar. This search expands on the search from the previous task and searches for the keyword fail*. The wildcard tells Splunk to expand the search term to find other terms that contain the word fail such as failure, failed, etc. Lastly, the keyword root searches for any event that contains the term root.
3. Click search.



-- Evaluate the search results --

Your search task should have retrieved search results for over 300 events. Navigate to other pages of the search results to observe the events not listed on the first page of results.

Pro tip: Splunk highlights search terms in search results to make it easier to identify where the search terms appear in the data.
