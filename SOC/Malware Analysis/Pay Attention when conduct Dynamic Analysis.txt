
We mentioned that the dynamic analysis is the method that we actually run the malware on our own system and analyze its activities on the operating system.


-- Process Activities --

When the malware is run, it creates a process of its own like other applications. All operations on the operating system are carried out through a process. Before following other activities, we must detect the processes belonging to the malware.

A large number of process, network, registry and file activities take place within the operating system. Since it may not be possible to analyze all these activities, we can start analyzing the activities of the malware processes to see if we can find anything solid about its activities.

When examining a process, special attention should be paid to information such as whether it creates a new child process, the DLLs it imports, and which user it is run by.


- Process Hacker -

Process Hacker makes it easy to examine processes by listing processes in a hierarchical view. When the malware creates a new process, you can see the newly created process under its parent process.

Malware can inject itself into different processes, perform activities for its own purposes with living of the land binaries, or make legitimate applications run their own applications. For these reasons, the activities of all processes belonging to the malware and used by the malware should be analyzed.

For instance, let’s say the malware injects itself into the notepad.exe process after it runs. In this case, we need to examine all of the activities that notepad.exe has created since the moment it was injected.


- Network Activities -

Malware often establish a network connection to download the second payload, to communicate with command and control (c2), to jump to other devices in the network, to steal data.

At the end of our malware analysis we need to detect these network connections.

Wireshark is a software that can meet all your needs for analyzing network activities. However, you may choose tools such as Fiddler, in cases where you know that the malware communicates especially over the HTTP protocol (Malware mostly communicates via protocols such as HTTP, SMTP).


- Registry Activities -

Attackers aim to ensure persistence by taking the advantage of the operating system, and adding their own malicious software to these registry keys

Some of these registry keys;

· HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
· HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
· HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run
· HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce

Since Registries are also used a lot by normal processes, you, specifically need to look at the registry changes made by malicious software processes.

Regshot can detect the changes that the malware has made on the Registries. Before executing the malware, you can run Regshot and click the "1st shot" button to let Regshot collect existing registries.
Then, you should press the "2nd shot" button to get a new shot after running the malware and allowing some time to show activity. You can see the differences between these two shots of Regshot by pressing the “Compare” button.


-- File Activities --

On Windows, there is a directory called "Temp" where temporary files are located. Applications usually use this directory to host their volatile files. Malware often copies itself to the Temp directory. For this reason, you should pay special attention to the activities performed on this directory.

In order to ensure persistence, malware also copies itself to the Startup directory, which contains applications that will run automatically when the operating system starts.

· %TEMP%
· shell:startup
· shell:common startup






































